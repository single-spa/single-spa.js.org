"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[9198],{3905:function(e,t,n){n.d(t,{Zo:function(){return u},kt:function(){return h}});var a=n(7294);function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function r(e,t){if(null==e)return{};var n,a,l=function(e,t){if(null==e)return{};var n,a,l={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(l[n]=e[n]);return l}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}var s=a.createContext({}),p=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},u=function(e){var t=p(e.components);return a.createElement(s.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},c=a.forwardRef((function(e,t){var n=e.components,l=e.mdxType,i=e.originalType,s=e.parentName,u=r(e,["components","mdxType","originalType","parentName"]),c=p(n),h=l,g=c["".concat(s,".").concat(h)]||c[h]||d[h]||i;return n?a.createElement(g,o(o({ref:t},u),{},{components:n})):a.createElement(g,o({ref:t},u))}));function h(e,t){var n=arguments,l=t&&t.mdxType;if("string"==typeof e||l){var i=n.length,o=new Array(i);o[0]=c;var r={};for(var s in t)hasOwnProperty.call(t,s)&&(r[s]=t[s]);r.originalType=e,r.mdxType="string"==typeof e?e:l,o[1]=r;for(var p=2;p<i;p++)o[p]=n[p];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}c.displayName="MDXCreateElement"},2337:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return r},contentTitle:function(){return s},metadata:function(){return p},toc:function(){return u},default:function(){return c}});var a=n(3117),l=n(102),i=(n(7294),n(3905)),o=["components"],r={id:"api",title:"Applications API",sidebar_label:"Applications API"},s=void 0,p={unversionedId:"api",id:"version-5.x/api",title:"Applications API",description:"Single-spa exports named functions and variables rather than a single default export.",source:"@site/versioned_docs/version-5.x/api.md",sourceDirName:".",slug:"/api",permalink:"/docs/api",editUrl:"https://github.com/single-spa/single-spa.js.org/blob/master/website/versioned_docs/version-5.x/api.md",tags:[],version:"5.x",frontMatter:{id:"api",title:"Applications API",sidebar_label:"Applications API"},sidebar:"version-5.x/docs",previous:{title:"Overview",permalink:"/docs/recommended-setup"},next:{title:"Parcels API",permalink:"/docs/parcels-api"}},u=[{value:"registerApplication",id:"registerapplication",children:[{value:"Simple arguments",id:"simple-arguments",children:[],level:3},{value:"Configuration object",id:"configuration-object",children:[],level:3}],level:2},{value:"start",id:"start",children:[],level:2},{value:"triggerAppChange",id:"triggerappchange",children:[],level:2},{value:"navigateToUrl",id:"navigatetourl",children:[],level:2},{value:"getMountedApps",id:"getmountedapps",children:[],level:2},{value:"getAppNames",id:"getappnames",children:[],level:2},{value:"getAppStatus",id:"getappstatus",children:[{value:"Handling LOAD_ERROR status to retry module",id:"handling-load_error-status-to-retry-module",children:[],level:3}],level:2},{value:"unloadApplication",id:"unloadapplication",children:[],level:2},{value:"unregisterApplication",id:"unregisterapplication",children:[],level:2},{value:"checkActivityFunctions",id:"checkactivityfunctions",children:[],level:2},{value:"addErrorHandler",id:"adderrorhandler",children:[],level:2},{value:"removeErrorHandler",id:"removeerrorhandler",children:[],level:2},{value:"mountRootParcel",id:"mountrootparcel",children:[],level:2},{value:"pathToActiveWhen",id:"pathtoactivewhen",children:[],level:2},{value:"ensureJQuerySupport",id:"ensurejquerysupport",children:[],level:2},{value:"setBootstrapMaxTime",id:"setbootstrapmaxtime",children:[],level:2},{value:"setMountMaxTime",id:"setmountmaxtime",children:[],level:2},{value:"setUnmountMaxTime",id:"setunmountmaxtime",children:[],level:2},{value:"setUnloadMaxTime",id:"setunloadmaxtime",children:[],level:2},{value:"Events",id:"events",children:[{value:"PopStateEvent",id:"popstateevent",children:[],level:3},{value:"Canceling navigation",id:"canceling-navigation",children:[],level:3},{value:"Custom Events",id:"custom-events",children:[],level:3},{value:"before-app-change event",id:"before-app-change-event",children:[],level:3},{value:"before-no-app-change",id:"before-no-app-change",children:[],level:3},{value:"before-routing-event",id:"before-routing-event",children:[],level:3},{value:"before-mount-routing-event",id:"before-mount-routing-event",children:[],level:3},{value:"before-first-mount",id:"before-first-mount",children:[],level:3},{value:"first-mount",id:"first-mount",children:[],level:3},{value:"app-change event",id:"app-change-event",children:[],level:3},{value:"no-app-change event",id:"no-app-change-event",children:[],level:3},{value:"routing-event",id:"routing-event",children:[],level:3}],level:2}],d={toc:u};function c(e){var t=e.components,n=(0,l.Z)(e,o);return(0,i.kt)("wrapper",(0,a.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"Single-spa exports named functions and variables rather than a single default export.\nThis means importing must happen in one of two ways:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"import { registerApplication, start } from 'single-spa';\n// or\nimport * as singleSpa from 'single-spa';\n")),(0,i.kt)("h2",{id:"registerapplication"},"registerApplication"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"registerApplication")," is the most important API your root config will use. Use this function to register any application within single-spa.\nNote that if an application is registered from within another application, that no hierarchy will be maintained between the applications."),(0,i.kt)("p",null,"There are two ways of registering your application:"),(0,i.kt)("h3",{id:"simple-arguments"},"Simple arguments"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"singleSpa.registerApplication(\n  'appName',\n  () => System.import('appName'),\n  location => location.pathname.startsWith('appName'),\n);\n")),(0,i.kt)("h3",null,"arguments"),(0,i.kt)("dl",{className:"args-list"},(0,i.kt)("dt",null,"appName: string"),(0,i.kt)("dd",null,"App name that single-spa will register and reference this application with, and will be labelled with in dev tools."),(0,i.kt)("dt",null,"applicationOrLoadingFn: () => <Function | Promise>"),(0,i.kt)("dd",null,"Must be a loading function that either returns the resolved application or a promise."),(0,i.kt)("dt",null,"activityFn: (location) => boolean"),(0,i.kt)("dd",null,"Must be a pure function. The function is called with ",(0,i.kt)("codehtml",null,"window.location")," as the first argument "," and should return a truthy value whenever the application should be active."),(0,i.kt)("dt",null,"customProps?: Object | () => Object"),(0,i.kt)("dd",null,"Will be passed to the application during each lifecycle method.")),(0,i.kt)("h3",null,"returns"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"undefined")),(0,i.kt)("h3",{id:"configuration-object"},"Configuration object"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"singleSpa.registerApplication({\n    name: 'appName',\n    app: () => System.import('appName'),\n    activeWhen: '/appName',\n    customProps: {\n        authToken: 'xc67f6as87f7s9d'\n    }\n})\n\nsingleSpa.registerApplication({\n    name: 'appName',\n    app: () => System.import('appName'),\n    activeWhen: '/appName',\n    // Dynamic custom props that can change based on route\n    customProps(appName, location) {\n        return {\n            authToken: 'xc67f6as87f7s9d'\n        }\n    }\n})\n")),(0,i.kt)("h3",null,"arguments"),(0,i.kt)("dl",{className:"args-list"},(0,i.kt)("dt",null,"name: string"),(0,i.kt)("dd",null,"App name that single-spa will register and reference this application with, and will be labelled with in dev tools."),(0,i.kt)("dt",null,"app: Application | () => Application | Promise<Application> "),(0,i.kt)("dd",null,"Application object or a function that returns the resolved application (Promise or not)"),(0,i.kt)("dt",null,"activeWhen: string | (location) => boolean | (string | (location) => boolean)[]"),(0,i.kt)("dd",null,"Can be a path prefix which will match every URL starting with this path, an activity function (as described in the simple arguments) or an array containing both of them. If any of the criteria is true, it will keep the application active. The path prefix also accepts dynamic values (they must start with ':'), as some paths would receive url params and should still trigger your application. Examples:",(0,i.kt)("dl",null,(0,i.kt)("dt",null,"'/app1'"),(0,i.kt)("dd",null,"\u2705 https://app.com/app1"),(0,i.kt)("dd",null,"\u2705 https://app.com/app1/anything/everything"),(0,i.kt)("dd",null,"\ud83d\udeab https://app.com/app2"),(0,i.kt)("dt",null,"'/users/:userId/profile'"),(0,i.kt)("dd",null,"\u2705 https://app.com/users/123/profile"),(0,i.kt)("dd",null,"\u2705 https://app.com/users/123/profile/sub-profile/"),(0,i.kt)("dd",null,"\ud83d\udeab https://app.com/users//profile/sub-profile/"),(0,i.kt)("dd",null,"\ud83d\udeab https://app.com/users/profile/sub-profile/"),(0,i.kt)("dt",null,"'/pathname/#/hash'"),(0,i.kt)("dd",null,"\u2705 https://app.com/pathname/#/hash"),(0,i.kt)("dd",null,"\u2705 https://app.com/pathname/#/hash/route/nested"),(0,i.kt)("dd",null,"\ud83d\udeab https://app.com/pathname#/hash/route/nested"),(0,i.kt)("dd",null,"\ud83d\udeab https://app.com/pathname#/another-hash"),(0,i.kt)("dt",null,"['/pathname/#/hash', '/app1']"),(0,i.kt)("dd",null,"\u2705 https://app.com/pathname/#/hash/route/nested"),(0,i.kt)("dd",null,"\u2705 https://app.com/app1/anything/everything"),(0,i.kt)("dd",null,"\ud83d\udeab https://app.com/pathname/app1"),(0,i.kt)("dd",null,"\ud83d\udeab https://app.com/app2"))),(0,i.kt)("dt",null,"customProps?: Object | () => Object"),(0,i.kt)("dd",null,"Will be passed to the application during each lifecycle method.")),(0,i.kt)("h3",null,"returns"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"undefined")),(0,i.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"It is described in detail inside of the ",(0,i.kt)("a",{parentName:"p",href:"configuration#registering-applications"},"Configuration docs")))),(0,i.kt)("h2",{id:"start"},"start"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"singleSpa.start();\n\n// Optionally, you can provide configuration\nsingleSpa.start({\n  urlRerouteOnly: true,\n});\n")),(0,i.kt)("p",null,"Must be called by your single spa config. Before ",(0,i.kt)("inlineCode",{parentName:"p"},"start")," is called, applications will be loaded, but will never be bootstrapped, mounted or unmounted. The reason for ",(0,i.kt)("inlineCode",{parentName:"p"},"start")," is to give you control over the performance of your single page application. For example, you may want to declare registered applications immediately (to start downloading the code for the active ones), but not actually mount the registered applications until an initial AJAX request (maybe to get information about the logged in user) has been completed. In that case, the best performance is achieved by calling ",(0,i.kt)("inlineCode",{parentName:"p"},"registerApplication")," immediately, but calling ",(0,i.kt)("inlineCode",{parentName:"p"},"start")," after the AJAX request is completed."),(0,i.kt)("h3",null,"arguments"),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"start(opts)")," api optionally accepts a single ",(0,i.kt)("inlineCode",{parentName:"p"},"opts")," object, with the following properties. If the opts object is omitted, all defaults will be applied."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"urlRerouteOnly"),": A boolean that defaults to false. If set to true, calls to ",(0,i.kt)("inlineCode",{parentName:"li"},"history.pushState()")," and ",(0,i.kt)("inlineCode",{parentName:"li"},"history.replaceState()")," will not trigger a single-spa reroute unless the client side route was changed. Setting this to true can be better for performance in some situations. For more information, read ",(0,i.kt)("a",{parentName:"li",href:"https://github.com/single-spa/single-spa/issues/484"},"original issue"),".")),(0,i.kt)("h3",null,"returns"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"undefined")),(0,i.kt)("h2",{id:"triggerappchange"},"triggerAppChange"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"singleSpa.triggerAppChange();\n")),(0,i.kt)("p",null,"Returns a Promise that will resolve/reject when all apps have mounted/unmounted. This was built for testing single-spa and is likely not\nneeded in a production application."),(0,i.kt)("h3",null,"arguments"),(0,i.kt)("p",null,"none"),(0,i.kt)("h3",null,"returns"),(0,i.kt)("dl",{className:"args-list"},(0,i.kt)("dt",null,"Promise"),(0,i.kt)("dd",null,"Returns a Promise that will resolve/reject when all apps have mounted.")),(0,i.kt)("h2",{id:"navigatetourl"},"navigateToUrl"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"// Three ways of using navigateToUrl\nsingleSpa.navigateToUrl('/new-url');\nsingleSpa.navigateToUrl(document.querySelector('a'));\ndocument.querySelector('a').addEventListener(singleSpa.navigateToUrl);\n")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-html"},'\x3c!-- A fourth way to use navigateToUrl, this one inside of your HTML --\x3e\n<a href="/new-url" onclick="singleSpaNavigate(event)">My link</a>\n')),(0,i.kt)("p",null,"Use this utility function to easily perform url navigation between registered applications without needing to deal with ",(0,i.kt)("inlineCode",{parentName:"p"},"event.preventDefault()"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"pushState"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"triggerAppChange()"),", etc."),(0,i.kt)("h3",null,"arguments"),(0,i.kt)("dl",{className:"args-list"},(0,i.kt)("dt",null,"navigationObj: string | context | DOMEvent"),(0,i.kt)("dd",null,"navigationObj must be one of the following types:",(0,i.kt)("ul",null,(0,i.kt)("li",null,"a url string."),(0,i.kt)("li",null,"a context / thisArg that has an ",(0,i.kt)("codehtml",null,"href")," property; useful for calling ",(0,i.kt)("codehtml",null,"singleSpaNavigate.call(anchorElement)")," with a reference to the anchor element or other context."),(0,i.kt)("li",null,"a DOMEvent object for a click event on a DOMElement that has an ",(0,i.kt)("codehtml",null,"href")," attribute; ideal for the ",(0,i.kt)("codehtml",null,'<a onclick="singleSpaNavigate"></a>')," use case.")))),(0,i.kt)("h3",null,"returns"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"undefined")),(0,i.kt)("h2",{id:"getmountedapps"},"getMountedApps"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"const mountedAppNames = singleSpa.getMountedApps();\nconsole.log(mountedAppNames); // ['app1', 'app2', 'navbar']\n")),(0,i.kt)("h3",null,"arguments"),(0,i.kt)("p",null,"none"),(0,i.kt)("h3",null,"returns"),(0,i.kt)("dl",{className:"args-list"},(0,i.kt)("dt",null,"appNames: string[]"),(0,i.kt)("dd",null,"Each string is the name of a registered application that is currently ",(0,i.kt)("codehtml",null,"MOUNTED"),".")),(0,i.kt)("h2",{id:"getappnames"},"getAppNames"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"const appNames = singleSpa.getAppNames();\nconsole.log(appNames); // ['app1', 'app2', 'app3', 'navbar']\n")),(0,i.kt)("h3",null,"arguments"),(0,i.kt)("p",null,"none"),(0,i.kt)("h3",null,"returns"),(0,i.kt)("dl",{className:"args-list"},(0,i.kt)("dt",null,"appNames: string[]"),(0,i.kt)("dd",null,"Each string is the name of a registered application regardless of app status.")),(0,i.kt)("h2",{id:"getappstatus"},"getAppStatus"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"const status = singleSpa.getAppStatus('app1');\nconsole.log(status); // one of many statuses (see list below). e.g. MOUNTED\n")),(0,i.kt)("h3",null,"arguments"),(0,i.kt)("dl",{className:"args-list"},(0,i.kt)("dt",null,"appName: string"),(0,i.kt)("dd",null,"Registered application name.")),(0,i.kt)("h3",null,"returns"),(0,i.kt)("dl",{className:"args-list"},(0,i.kt)("dt",null,"appStatus: <string | null>"),(0,i.kt)("dd",null,"Will be one of the following string constants, or ",(0,i.kt)("codehtml",null,"null")," if the app does not exist.",(0,i.kt)("dl",{className:"dl-inline"},(0,i.kt)("div",null,(0,i.kt)("dt",null,"NOT_LOADED"),(0,i.kt)("dd",null,"app has been registered with single-spa but has not yet been loaded.")),(0,i.kt)("div",null,(0,i.kt)("dt",null,"LOADING_SOURCE_CODE"),(0,i.kt)("dd",null,"app's source code is being fetched.")),(0,i.kt)("div",null,(0,i.kt)("dt",null,"NOT_BOOTSTRAPPED"),(0,i.kt)("dd",null,"app has been loaded but not bootstrapped.")),(0,i.kt)("div",null,(0,i.kt)("dt",null,"BOOTSTRAPPING"),(0,i.kt)("dd",null,"the ",(0,i.kt)("codehtml",null,"bootstrap")," lifecycle function has been called but has not finished.")),(0,i.kt)("div",null,(0,i.kt)("dt",null,"NOT_MOUNTED"),(0,i.kt)("dd",null,"app has been loaded and bootstrapped but not yet mounted.")),(0,i.kt)("div",null,(0,i.kt)("dt",null,"MOUNTING"),(0,i.kt)("dd",null,"app is being mounted but not finished.")),(0,i.kt)("div",null,(0,i.kt)("dt",null,"MOUNTED"),(0,i.kt)("dd",null,"app is currently active and is mounted to the DOM.")),(0,i.kt)("div",null,(0,i.kt)("dt",null,"UNMOUNTING"),(0,i.kt)("dd",null,"app is currently being unmounted but has not finished.")),(0,i.kt)("div",null,(0,i.kt)("dt",null,"UNLOADING"),(0,i.kt)("dd",null,"app is currently being unloaded but has not finished.")),(0,i.kt)("div",null,(0,i.kt)("dt",null,"SKIP_BECAUSE_BROKEN"),(0,i.kt)("dd",null,"app threw an error during load, bootstrap, mount, or unmount and has been siloed because it is misbehaving and has been skipped. Other apps will continue on normally.")),(0,i.kt)("div",null,(0,i.kt)("dt",null,"LOAD_ERROR"),(0,i.kt)("dd",null,"The app's loading function returned a promise that rejected. This is often due to a network error attempting to download the JavaScript bundle for the application. Single-spa will retry loading the application after the user navigates away from the current route and then comes back to it."))))),(0,i.kt)("h3",{id:"handling-load_error-status-to-retry-module"},"Handling LOAD_ERROR status to retry module"),(0,i.kt)("p",null,"If a module fails to load (for example, due to network error), single-spa will handle the error but SystemJS will not automatically retry to download the module later. To do so, add a single-spa errorHandler that deletes the module from the SystemJS registry and re-attempt to download the module when ",(0,i.kt)("inlineCode",{parentName:"p"},"System.import()")," on an application in ",(0,i.kt)("inlineCode",{parentName:"p"},"LOAD_ERROR")," status is called again."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"singleSpa.addErrorHandler(err => {\n  if (singleSpa.getAppStatus(err.appOrParcelName) === singleSpa.LOAD_ERROR) {\n    System.delete(System.resolve(err.appOrParcelName));\n  }\n});\n")),(0,i.kt)("h2",{id:"unloadapplication"},"unloadApplication"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"// Unload the application right now, without waiting for it to naturally unmount.\nsingleSpa.unloadApplication('app1');\n\n// Unload the application only after it naturally unmounts due to a route change.\nsingleSpa.unloadApplication('app1', { waitForUnmount: true });\n")),(0,i.kt)("p",null,"The purpose of unloading a registered application is to set it back to a NOT_LOADED status, which means that it will be re-bootstrapped the next time it needs to mount. The main use-case for this was to allow for the hot-reloading of entire registered applications, but ",(0,i.kt)("inlineCode",{parentName:"p"},"unloadApplication")," can be useful whenever you want to re-bootstrap your application."),(0,i.kt)("p",null,"Single-spa performs the following steps when unloadApplication is called."),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Call the ",(0,i.kt)("a",{parentName:"li",href:"/docs/api#unload"},"unload lifecyle")," on the registered application that is being unloaded."),(0,i.kt)("li",{parentName:"ol"},"Set the app status to NOT_LOADED"),(0,i.kt)("li",{parentName:"ol"},"Trigger a reroute, during which single-spa will potentially mount the application that was just unloaded.")),(0,i.kt)("p",null,"Because a registered application might be mounted when ",(0,i.kt)("inlineCode",{parentName:"p"},"unloadApplication")," is called, you can specify whether you want to immediately unload or if you want to wait until the application is no longer mounted. This is done with the ",(0,i.kt)("inlineCode",{parentName:"p"},"waitForUnmount")," option."),(0,i.kt)("h3",null,"arguments"),(0,i.kt)("dl",{className:"args-list"},(0,i.kt)("dt",null,"appName: string"),(0,i.kt)("dd",null,"Registered application name."),(0,i.kt)("dt",null,"options?: {waitForUnmount: boolean = false}"),(0,i.kt)("dd",null,"The options must be an object that has a ",(0,i.kt)("codehtml",null,"waitForUnmount")," property. When ",(0,i.kt)("codehtml",null,"waitForUnmount")," is ",(0,i.kt)("codehtml",null,"false"),", single-spa immediately unloads the specified registered application even if the app is currently mounted. If it is ",(0,i.kt)("codehtml",null,"true"),", single-spa will unload the registered application as soon as it is safe to do so (when the app status is not ",(0,i.kt)("codehtml",null,"MOUNTED"),").")),(0,i.kt)("h3",null,"returns"),(0,i.kt)("dl",{className:"args-list"},(0,i.kt)("dt",null,"Promise"),(0,i.kt)("dd",null,"This promise will be resolved when the registered application has been successfully unloaded.")),(0,i.kt)("h2",{id:"unregisterapplication"},"unregisterApplication"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"import { unregisterApplication } from 'single-spa';\n\nunregisterApplication('app1').then(() => {\n  console.log('app1 is now unmounted, unloaded, and no longer registered!');\n});\n")),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"unregisterApplication")," function will unmount, unload, and unregister an application. Once it is no longer registered, the application will never again be mounted."),(0,i.kt)("p",null,"This api was introduced in ",(0,i.kt)("a",{parentName:"p",href:"mailto:single-spa@5.8.0."},"single-spa@5.8.0.")," A few notes about this api:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Unregistering an application does not delete it from the SystemJS module registry."),(0,i.kt)("li",{parentName:"ul"},"Unregistering an application does not delete its code or javascript frameworks from browser memory."),(0,i.kt)("li",{parentName:"ul"},"An alternative to unregistering applications is to perform permission checks inside of the application's activity function. This has a similar effect of preventing the application from ever mounting.")),(0,i.kt)("h3",null,"arguments"),(0,i.kt)("dl",{className:"args-list"},(0,i.kt)("dt",null,"appName: string")),(0,i.kt)("h3",null,"returns"),(0,i.kt)("dl",{className:"args-list"},(0,i.kt)("dt",null,"Promise"),(0,i.kt)("dd",null,"This promise will be resolved when the application has been successfully unregistered.")),(0,i.kt)("h2",{id:"checkactivityfunctions"},"checkActivityFunctions"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"const appsThatShouldBeActive = singleSpa.checkActivityFunctions();\nconsole.log(appsThatShouldBeActive); // ['app1']\n\nconst appsForACertainRoute = singleSpa.checkActivityFunctions(new URL('/app2', window.location.href));\nconsole.log(appsForACertainRoute); // ['app2']\n")),(0,i.kt)("p",null,"Will call every app's activity function with ",(0,i.kt)("inlineCode",{parentName:"p"},"url")," and give you list of which applications should be mounted with that location."),(0,i.kt)("h3",null,"arguments"),(0,i.kt)("dl",{className:"args-list"},(0,i.kt)("dt",null,"location: Location"),(0,i.kt)("dd",null,"A ",(0,i.kt)("codehtml",null,"Location")," object that will be used instead of window.location when calling every application's activity function to test if they return true.")),(0,i.kt)("h3",null,"returns"),(0,i.kt)("dl",{className:"args-list"},(0,i.kt)("dt",null,"appNames: string[]"),(0,i.kt)("dd",null,"Each string is the name of a registered application that matches the provided ",(0,i.kt)("codehtml",null,"url"),".")),(0,i.kt)("h2",{id:"adderrorhandler"},"addErrorHandler"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"singleSpa.addErrorHandler(err => {\n  console.log(err);\n  console.log(err.appOrParcelName);\n  console.log(singleSpa.getAppStatus(err.appOrParcelName));\n});\n")),(0,i.kt)("p",null,"Adds a handler that will be called every time an application throws an error during a lifecycle function or activity function. When there are no error handlers, single-spa throws the error to the window."),(0,i.kt)("dl",{className:"args-list"},(0,i.kt)("dt",null,"errorHandler: Function(error: Error)"),(0,i.kt)("dd",null,"Must be a function. Will be called with an ",(0,i.kt)("a",{href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error"},"Error object")," that additionally has a ",(0,i.kt)("codehtml",null,"message")," and ",(0,i.kt)("codehtml",null,"appOrParcelName")," property.")),(0,i.kt)("h3",null,"returns"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"undefined")),(0,i.kt)("h2",{id:"removeerrorhandler"},"removeErrorHandler"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"singleSpa.addErrorHandler(handleErr);\nsingleSpa.removeErrorHandler(handleErr);\n\nfunction handleErr(err) {\n  console.log(err);\n}\n")),(0,i.kt)("p",null,"Removes the given error handler function."),(0,i.kt)("h3",null,"arguments"),(0,i.kt)("dl",{className:"args-list"},(0,i.kt)("dt",null,"errorHandler: Function"),(0,i.kt)("dd",null,"Reference to the error handling function.")),(0,i.kt)("h3",null,"returns"),(0,i.kt)("dl",{className:"args-list"},(0,i.kt)("dt",null,"boolean"),(0,i.kt)("dd",null,(0,i.kt)("codehtml",null,"true")," if the error handler was removed, and ",(0,i.kt)("codehtml",null,"false")," if it was not.")),(0,i.kt)("h2",{id:"mountrootparcel"},"mountRootParcel"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"// Synchronous mounting\nconst parcel = singleSpa.mountRootParcel(parcelConfig, {\n  prop1: 'value1',\n  domElement: document.getElementById('a-div'),\n});\nparcel.mountPromise.then(() => {\n  console.log('finished mounting the parcel!');\n});\n\n// Asynchronous mounting. Feel free to use webpack code splits or SystemJS dynamic loading\nconst parcel2 = singleSpa.mountRootParcel(() => import('./some-parcel.js'), {\n  prop1: 'value1',\n  domElement: document.getElementById('a-div'),\n});\n")),(0,i.kt)("p",null,"Will create and mount a ",(0,i.kt)("a",{parentName:"p",href:"/docs/parcels-overview"},"single-spa parcel"),"."),(0,i.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"Parcels do not automatically unmount")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"Unmounting will need to be triggered manually."))),(0,i.kt)("h3",null,"arguments"),(0,i.kt)("dl",{className:"args-list"},(0,i.kt)("dt",null,"parcelConfig: Object or Loading Function"),(0,i.kt)("dd",null,"[parcelConfig](/docs/parcels-api#parcel-configuration)"),(0,i.kt)("dt",null,"parcelProps: Object with a domElement property"),(0,i.kt)("dd",null,"[parcelProps](/docs/parcels-api#parcel-props)")),(0,i.kt)("h3",null,"returns"),(0,i.kt)("dl",{className:"args-list"},(0,i.kt)("dt",null,"Parcel object"),(0,i.kt)("dd",null,"See ",(0,i.kt)("a",{href:"/docs/parcels-api.html"},"Parcels API")," for more detail.")),(0,i.kt)("h2",{id:"pathtoactivewhen"},"pathToActiveWhen"),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"pathToActiveWhen")," function converts a string URL path into an ",(0,i.kt)("a",{parentName:"p",href:"/docs/configuration/#activity-function"},"activity function"),". The string path may contain route parameters that single-spa will match any characters to. By default, pathToActiveWhen assumes that the string provided is a ",(0,i.kt)("strong",{parentName:"p"},"prefix"),"; however, this can be altered with the ",(0,i.kt)("inlineCode",{parentName:"p"},"exactMatch")," parameter."),(0,i.kt)("p",null,"This function is used by single-spa when a string is passed into ",(0,i.kt)("inlineCode",{parentName:"p"},"registerApplication")," as the ",(0,i.kt)("inlineCode",{parentName:"p"},"activeWhen")," argument."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("em",{parentName:"strong"},"Arguments"))),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("inlineCode",{parentName:"li"},"path")," (string): The URL prefix that."),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("inlineCode",{parentName:"li"},"exactMatch")," (boolean, optional, defaults to ",(0,i.kt)("inlineCode",{parentName:"li"},"false"),", requires single-spa@>=5.9.0): A boolean that controls whether trailing characters after the path should be allowed. When ",(0,i.kt)("inlineCode",{parentName:"li"},"false"),", trailing characters are allowed. When ",(0,i.kt)("inlineCode",{parentName:"li"},"true"),", trailing characters are not allowed.")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("em",{parentName:"strong"},"Return Value"))),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"(url: URL) => boolean")),(0,i.kt)("p",null,"A function that accepts a ",(0,i.kt)("inlineCode",{parentName:"p"},"URL")," object as an argument and returns a boolean indicating whether the path matches that URL."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("em",{parentName:"strong"},"Examples:"))),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"let activeWhen = singleSpa.pathToActiveWhen('/settings');\nactiveWhen(new URL('http://localhost/settings')); // true\nactiveWhen(new URL('http://localhost/settings/password')); // true\nactiveWhen(new URL('http://localhost/')); // false\n\nactiveWhen = singleSpa.pathToActiveWhen('/users/:id/settings');\nactiveWhen(new URL('http://localhost/users/6f7dsdf8g9df8g9dfg/settings')); // true\nactiveWhen(new URL('http://localhost/users/1324/settings')); // true\nactiveWhen(new URL('http://localhost/users/1324/settings/password')); // true\nactiveWhen(new URL('http://localhost/users/1/settings')); // true\nactiveWhen(new URL('http://localhost/users/1')); // false\nactiveWhen(new URL('http://localhost/settings')); // false\nactiveWhen(new URL('http://localhost/')); // false\n\nactiveWhen = singleSpa.pathToActiveWhen('/page#/hash');\nactiveWhen(new URL('http://localhost/page#/hash')); // true\nactiveWhen(new URL('http://localhost/#/hash')); // false\nactiveWhen(new URL('http://localhost/page')); // false\n")),(0,i.kt)("h2",{id:"ensurejquerysupport"},"ensureJQuerySupport"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"singleSpa.ensureJQuerySupport(jQuery);\n")),(0,i.kt)("p",null,"jQuery uses ",(0,i.kt)("a",{parentName:"p",href:"https://learn.jquery.com/events/event-delegation/"},"event delegation")," so single-spa must monkey-patch each version of jQuery on the page",". single-spa will attempt to do this automatically by looking for ",(0,i.kt)("inlineCode",{parentName:"p"},"window.jQuery")," or ",(0,i.kt)("inlineCode",{parentName:"p"},"window.$"),". Use this explicit method if multiple versions are included on your page or if jQuery is bound to a different global variable."),(0,i.kt)("h3",null,"arguments"),(0,i.kt)("dl",{className:"args-list"},(0,i.kt)("dt",null,"jQuery?: JQueryFn = window.jQuery"),(0,i.kt)("dd",null,"A reference to the global variable that jQuery has been bound to.")),(0,i.kt)("h3",null,"returns"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"undefined")),(0,i.kt)("h2",{id:"setbootstrapmaxtime"},"setBootstrapMaxTime"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"// After three seconds, show a console warning while continuing to wait.\nsingleSpa.setBootstrapMaxTime(3000);\n\n// After three seconds, move the application to SKIP_BECAUSE_BROKEN status.\nsingleSpa.setBootstrapMaxTime(3000, true);\n\n// don't do a console warning for slow lifecycles until 10 seconds have elapsed\nsingleSpa.setBootstrapMaxTime(3000, true, 10000);\n")),(0,i.kt)("p",null,"Sets the global configuration for bootstrap timeouts."),(0,i.kt)("h3",null,"arguments"),(0,i.kt)("dl",{className:"args-list"},(0,i.kt)("dt",null,"millis: number"),(0,i.kt)("dd",null,"Number of milliseconds to wait for bootstrap to complete before timing out."),(0,i.kt)("dt",null,"dieOnTimeout: boolean = false"),(0,i.kt)("dd",null,(0,i.kt)("p",null,"If false, registered applications that are slowing things down will cause nothing more than some warnings in the console up until ",(0,i.kt)("codehtml",null,"millis")," is reached."),(0,i.kt)("p",null,"If true, registered applications that are slowing things down will be siloed into a SKIP_BECAUSE_BROKEN status where they will never again be given the chance to break everything."),(0,i.kt)("p",null,"Each registered application can override this behavior for itself.")),(0,i.kt)("dt",null,"warningMillis: number = 1000"),(0,i.kt)("dd",null,"Number of milliseconds to wait between console warnings that occur before the final timeout.")),(0,i.kt)("h3",null,"returns"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"undefined")),(0,i.kt)("h2",{id:"setmountmaxtime"},"setMountMaxTime"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"// After three seconds, show a console warning while continuing to wait.\nsingleSpa.setMountMaxTime(3000);\n\n// After three seconds, move the application to SKIP_BECAUSE_BROKEN status.\nsingleSpa.setMountMaxTime(3000, true);\n\n// don't do a console warning for slow lifecycles until 10 seconds have elapsed\nsingleSpa.setMountMaxTime(3000, true, 10000);\n")),(0,i.kt)("p",null,"Sets the global configuration for mount timeouts."),(0,i.kt)("h3",null,"arguments"),(0,i.kt)("dl",{className:"args-list"},(0,i.kt)("dt",null,"millis: number"),(0,i.kt)("dd",null,"Number of milliseconds to wait for mount to complete before timing out."),(0,i.kt)("dt",null,"dieOnTimeout: boolean = false"),(0,i.kt)("dd",null,(0,i.kt)("p",null,"If false, registered applications that are slowing things down will cause nothing more than some warnings in the console up until ",(0,i.kt)("codehtml",null,"millis")," is reached."),(0,i.kt)("p",null,"If true, registered applications that are slowing things down will be siloed into a SKIP_BECAUSE_BROKEN status where they will never again be given the chance to break everything."),(0,i.kt)("p",null,"Each registered application can override this behavior for itself.")),(0,i.kt)("dt",null,"warningMillis: number = 1000"),(0,i.kt)("dd",null,"Number of milliseconds to wait between console warnings that occur before the final timeout.")),(0,i.kt)("h3",null,"returns"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"undefined")),(0,i.kt)("h2",{id:"setunmountmaxtime"},"setUnmountMaxTime"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"// After three seconds, show a console warning while continuing to wait.\nsingleSpa.setUnmountMaxTime(3000);\n\n// After three seconds, move the application to SKIP_BECAUSE_BROKEN status.\nsingleSpa.setUnmountMaxTime(3000, true);\n\n// don't do a console warning for slow lifecycles until 10 seconds have elapsed\nsingleSpa.setUnmountMaxTime(3000, true, 10000);\n")),(0,i.kt)("p",null,"Sets the global configuration for unmount timeouts."),(0,i.kt)("h3",null,"arguments"),(0,i.kt)("dl",{className:"args-list"},(0,i.kt)("dt",null,"millis: number"),(0,i.kt)("dd",null,"Number of milliseconds to wait for unmount to complete before timing out."),(0,i.kt)("dt",null,"dieOnTimeout: boolean = false"),(0,i.kt)("dd",null,(0,i.kt)("p",null,"If false, registered applications that are slowing things down will cause nothing more than some warnings in the console up until ",(0,i.kt)("codehtml",null,"millis")," is reached."),(0,i.kt)("p",null,"If true, registered applications that are slowing things down will be siloed into a SKIP_BECAUSE_BROKEN status where they will never again be given the chance to break everything."),(0,i.kt)("p",null,"Each registered application can override this behavior for itself.")),(0,i.kt)("dt",null,"warningMillis: number = 1000"),(0,i.kt)("dd",null,"Number of milliseconds to wait between console warnings that occur before the final timeout.")),(0,i.kt)("h3",null,"returns"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"undefined")),(0,i.kt)("hr",null),(0,i.kt)("h2",{id:"setunloadmaxtime"},"setUnloadMaxTime"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"// After three seconds, show a console warning while continuing to wait.\nsingleSpa.setUnloadMaxTime(3000);\n\n// After three seconds, move the application to SKIP_BECAUSE_BROKEN status.\nsingleSpa.setUnloadMaxTime(3000, true);\n\n// don't do a console warning for slow lifecycles until 10 seconds have elapsed\nsingleSpa.setUnloadMaxTime(3000, true, 10000);\n")),(0,i.kt)("p",null,"Sets the global configuration for unload timeouts."),(0,i.kt)("h3",null,"arguments"),(0,i.kt)("dl",{className:"args-list"},(0,i.kt)("dt",null,"millis: number"),(0,i.kt)("dd",null,"Number of milliseconds to wait for unload to complete before timing out."),(0,i.kt)("dt",null,"dieOnTimeout: boolean = false"),(0,i.kt)("dd",null,(0,i.kt)("p",null,"If false, registered applications that are slowing things down will cause nothing more than some warnings in the console up until ",(0,i.kt)("codehtml",null,"millis")," is reached."),(0,i.kt)("p",null,"If true, registered applications that are slowing things down will be siloed into a SKIP_BECAUSE_BROKEN status where they will never again be given the chance to break everything."),(0,i.kt)("p",null,"Each registered application can override this behavior for itself.")),(0,i.kt)("dt",null,"warningMillis: number = 1000"),(0,i.kt)("dd",null,"Number of milliseconds to wait between console warnings that occur before the final timeout.")),(0,i.kt)("h3",null,"returns"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"undefined")),(0,i.kt)("h2",{id:"events"},"Events"),(0,i.kt)("p",null,"single-spa fires Events to the ",(0,i.kt)("inlineCode",{parentName:"p"},"window")," as a way for your code to hook into URL transitions."),(0,i.kt)("h3",{id:"popstateevent"},"PopStateEvent"),(0,i.kt)("p",null,"single-spa fires ",(0,i.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/API/PopStateEvent"},"PopStateEvent")," events when it wants to instruct all active applications to re-render. This occurs when one application calls ",(0,i.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/API/History/pushState"},"history.pushState"),", ",(0,i.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/API/History/replaceState"},"history.replaceState"),", or ",(0,i.kt)("a",{parentName:"p",href:"#triggerAppChange"},"triggerAppChange"),". Single-spa deviates from the browser's default behavior in some cases, as described in ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/single-spa/single-spa/issues/484#issuecomment-601279869"},"this Github issue"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"window.addEventListener('popstate', evt => {\n  if (evt.singleSpa) {\n    console.log(\n      'This event was fired by single-spa to forcibly trigger a re-render',\n    );\n    console.log(evt.singleSpaTrigger); // pushState | replaceState\n  } else {\n    console.log('This event was fired by native browser behavior');\n  }\n});\n")),(0,i.kt)("h3",{id:"canceling-navigation"},"Canceling navigation"),(0,i.kt)("p",null,"Canceling navigation refers to the URL changing and then immediately changing back to what it was before. This is done before any mounting, unmounting, or loading that would otherwise take place. This can be used in conjunction with Vue router and Angular router's built-in navigation guards that allow for cancelation of a navigation event."),(0,i.kt)("p",null,"To cancel a navigation event, listen to the ",(0,i.kt)("inlineCode",{parentName:"p"},"single-spa:before-routing-event")," event:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"window.addEventListener(\n  'single-spa:before-routing-event',\n  ({ detail: { oldUrl, newUrl, cancelNavigation } }) => {\n    if (\n      new URL(oldUrl).pathname === '/route1' &&\n      new URL(newUrl).pathname === '/route2'\n    ) {\n      cancelNavigation();\n    }\n  },\n);\n")),(0,i.kt)("p",null,"When a navigation is canceled, no applications will be mounted, unmounted, loaded, or unloaded. All single-spa routing events will fire for the canceled navigation, but they will each have the ",(0,i.kt)("inlineCode",{parentName:"p"},"navigationIsCanceled")," property set to ",(0,i.kt)("inlineCode",{parentName:"p"},"true")," on the ",(0,i.kt)("inlineCode",{parentName:"p"},"event.detail")," (Details below in Custom Events section)."),(0,i.kt)("p",null,"Navigation cancelation is sometimes used as a mechanism for preventing users from accessing routes for which they are unauthorized. However, we generally recommend permission checks on each route as the proper way to guard routes, instead of navigation cancelation."),(0,i.kt)("h3",{id:"custom-events"},"Custom Events"),(0,i.kt)("p",null,"single-spa fires a series of ",(0,i.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent/CustomEvent"},"custom events")," whenever it reroutes. A reroute occurs whenever the browser URL changes in any way or a ",(0,i.kt)("inlineCode",{parentName:"p"},"triggerAppChange")," is called. The custom events are fired to the ",(0,i.kt)("inlineCode",{parentName:"p"},"window"),". Each custom event has a ",(0,i.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent/detail"},(0,i.kt)("inlineCode",{parentName:"a"},"detail")," property")," with the following properties:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"window.addEventListener('single-spa:before-routing-event', evt => {\n  const {\n    originalEvent,\n    newAppStatuses,\n    appsByNewStatus,\n    totalAppChanges,\n    oldUrl,\n    newUrl,\n    navigationIsCanceled,\n    cancelNavigation,\n  } = evt.detail;\n  console.log(\n    'original event that triggered this single-spa event',\n    originalEvent,\n  ); // PopStateEvent | HashChangeEvent | undefined\n  console.log(\n    'the new status for all applications after the reroute finishes',\n    newAppStatuses,\n  ); // { app1: MOUNTED, app2: NOT_MOUNTED }\n  console.log(\n    'the applications that changed, grouped by their status',\n    appsByNewStatus,\n  ); // { MOUNTED: ['app1'], NOT_MOUNTED: ['app2'] }\n  console.log(\n    'number of applications that changed status so far during this reroute',\n    totalAppChanges,\n  ); // 2\n  console.log('the URL before the navigationEvent', oldUrl); // http://localhost:8080/old-route\n  console.log('the URL after the navigationEvent', newUrl); // http://localhost:8080/new-route\n  console.log('has the navigation been canceled', navigationIsCanceled); // false\n\n  // The cancelNavigation function is only defined in the before-routing-event\n  evt.detail.cancelNavigation();\n});\n")),(0,i.kt)("p",null,"The following table shows the order in which the custom events are fired during a reroute:"),(0,i.kt)("table",null,(0,i.kt)("thead",{parentName:"table"},(0,i.kt)("tr",{parentName:"thead"},(0,i.kt)("th",{parentName:"tr",align:null},"Event order"),(0,i.kt)("th",{parentName:"tr",align:null},"Event Name"),(0,i.kt)("th",{parentName:"tr",align:null},"Condition for firing"))),(0,i.kt)("tbody",{parentName:"table"},(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"1"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"single-spa:before-app-change")," or ",(0,i.kt)("inlineCode",{parentName:"td"},"single-spa:before-no-app-change")),(0,i.kt)("td",{parentName:"tr",align:null},"Will any applications change status?")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"2"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"single-spa:before-routing-event")),(0,i.kt)("td",{parentName:"tr",align:null},"\u2014")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"3"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"single-spa:before-mount-routing-event")),(0,i.kt)("td",{parentName:"tr",align:null},"\u2014")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"4"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"single-spa:before-first-mount")),(0,i.kt)("td",{parentName:"tr",align:null},"Is this the first time any application is mounting?")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"5"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"single-spa:first-mount")),(0,i.kt)("td",{parentName:"tr",align:null},"Is this the first time any application was mounted?")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"6"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"single-spa:app-change")," or ",(0,i.kt)("inlineCode",{parentName:"td"},"single-spa:no-app-change")),(0,i.kt)("td",{parentName:"tr",align:null},"Did any applications change status?")),(0,i.kt)("tr",{parentName:"tbody"},(0,i.kt)("td",{parentName:"tr",align:null},"7"),(0,i.kt)("td",{parentName:"tr",align:null},(0,i.kt)("inlineCode",{parentName:"td"},"single-spa:routing-event")),(0,i.kt)("td",{parentName:"tr",align:null},"\u2014")))),(0,i.kt)("h3",{id:"before-app-change-event"},"before-app-change event"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"window.addEventListener('single-spa:before-app-change', evt => {\n  console.log('single-spa is about to mount/unmount applications!');\n  console.log(evt.detail.originalEvent); // PopStateEvent\n  console.log(evt.detail.newAppStatuses); // { app1: MOUNTED }\n  console.log(evt.detail.appsByNewStatus); // { MOUNTED: ['app1'], NOT_MOUNTED: [] }\n  console.log(evt.detail.totalAppChanges); // 1\n});\n")),(0,i.kt)("p",null,"A ",(0,i.kt)("inlineCode",{parentName:"p"},"single-spa:before-app-change")," event is fired before reroutes that will result in at least one application changing status."),(0,i.kt)("h3",{id:"before-no-app-change"},"before-no-app-change"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"window.addEventListener('single-spa:before-no-app-change', evt => {\n  console.log('single-spa is about to do a no-op reroute');\n  console.log(evt.detail.originalEvent); // PopStateEvent\n  console.log(evt.detail.newAppStatuses); // { }\n  console.log(evt.detail.appsByNewStatus); // { MOUNTED: [], NOT_MOUNTED: [] }\n  console.log(evt.detail.totalAppChanges); // 0\n});\n")),(0,i.kt)("p",null,"A ",(0,i.kt)("inlineCode",{parentName:"p"},"single-spa:before-no-app-change")," event is fired before reroutes that will result in zero applications changing status."),(0,i.kt)("h3",{id:"before-routing-event"},"before-routing-event"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"window.addEventListener('single-spa:before-routing-event', evt => {\n  console.log('single-spa is about to mount/unmount applications!');\n  console.log(evt.detail.originalEvent); // PopStateEvent\n  console.log(evt.detail.newAppStatuses); // { }\n  console.log(evt.detail.appsByNewStatus); // { MOUNTED: [], NOT_MOUNTED: [] }\n  console.log(evt.detail.totalAppChanges); // 0\n});\n")),(0,i.kt)("p",null,"A ",(0,i.kt)("inlineCode",{parentName:"p"},"single-spa:before-routing-event")," event is fired before every routing event occurs, which is after each hashchange, popstate, or triggerAppChange, even if no changes to registered applications were necessary."),(0,i.kt)("h3",{id:"before-mount-routing-event"},"before-mount-routing-event"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"window.addEventListener('single-spa:before-mount-routing-event', evt => {\n  console.log('single-spa is about to mount/unmount applications!');\n  console.log(evt.detail);\n  console.log(evt.detail.originalEvent); // PopStateEvent\n  console.log(evt.detail.newAppStatuses); // { app1: MOUNTED }\n  console.log(evt.detail.appsByNewStatus); // { MOUNTED: ['app1'], NOT_MOUNTED: [] }\n  console.log(evt.detail.totalAppChanges); // 1\n});\n")),(0,i.kt)("p",null,"A ",(0,i.kt)("inlineCode",{parentName:"p"},"single-spa:before-mount-routing-event")," event is fired after ",(0,i.kt)("inlineCode",{parentName:"p"},"before-routing-event")," and before ",(0,i.kt)("inlineCode",{parentName:"p"},"routing-event"),". It is guaranteed to fire after all single-spa applications have been unmounted, but before any new applications have been mounted."),(0,i.kt)("h3",{id:"before-first-mount"},"before-first-mount"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"window.addEventListener('single-spa:before-first-mount', () => {\n  console.log(\n    'single-spa is about to mount the very first application for the first time',\n  );\n});\n")),(0,i.kt)("p",null,"Before the first of any single-spa applications is mounted, single-spa fires a ",(0,i.kt)("inlineCode",{parentName:"p"},"single-spa:before-first-mount")," event; therefore it will only be fired once ever. More specifically, it fires after the application is already loaded but before mounting."),(0,i.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"Suggested use case")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"remove a loader bar that the user is seeing right before the first app will be mounted."))),(0,i.kt)("h3",{id:"first-mount"},"first-mount"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"window.addEventListener('single-spa:first-mount', () => {\n  console.log('single-spa just mounted the very first application');\n});\n")),(0,i.kt)("p",null,"After the first of any single-spa applications is mounted, single-spa fires a ",(0,i.kt)("inlineCode",{parentName:"p"},"single-spa:first-mount")," event; therefore it will only be fired once ever."),(0,i.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"Suggested use case")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"log the time it took before the user sees any of the apps mounted."))),(0,i.kt)("h3",{id:"app-change-event"},"app-change event"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"window.addEventListener('single-spa:app-change', evt => {\n  console.log(\n    'A routing event occurred where at least one application was mounted/unmounted',\n  );\n  console.log(evt.detail.originalEvent); // PopStateEvent\n  console.log(evt.detail.newAppStatuses); // { app1: MOUNTED, app2: NOT_MOUNTED }\n  console.log(evt.detail.appsByNewStatus); // { MOUNTED: ['app1'], NOT_MOUNTED: ['app2'] }\n  console.log(evt.detail.totalAppChanges); // 2\n});\n")),(0,i.kt)("p",null,"A ",(0,i.kt)("inlineCode",{parentName:"p"},"single-spa:app-change")," event is fired every time that one or more apps were loaded, bootstrapped, mounted, unmounted, or unloaded. It is similar to ",(0,i.kt)("inlineCode",{parentName:"p"},"single-spa:routing-event")," except that it will not fire unless one or more apps were actually loaded, bootstrapped, mounted, or unmounted. A hashchange, popstate, or triggerAppChange that does not result in one of those changes will not cause the event to be fired."),(0,i.kt)("h3",{id:"no-app-change-event"},"no-app-change event"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"window.addEventListener('single-spa:no-app-change', evt => {\n  console.log(\n    'A routing event occurred where zero applications were mounted/unmounted',\n  );\n  console.log(evt.detail.originalEvent); // PopStateEvent\n  console.log(evt.detail.newAppStatuses); // { }\n  console.log(evt.detail.appsByNewStatus); // { MOUNTED: [], NOT_MOUNTED: [] }\n  console.log(evt.detail.totalAppChanges); // 0\n});\n")),(0,i.kt)("p",null,"When no applications were loaded, bootstrapped, mounted, unmounted, or unloaded, single-spa fires a ",(0,i.kt)("inlineCode",{parentName:"p"},"single-spa:no-app-change")," event. This is the inverse of the ",(0,i.kt)("inlineCode",{parentName:"p"},"single-spa:app-change")," event. Only one will be fired for each routing event."),(0,i.kt)("h3",{id:"routing-event"},"routing-event"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js"},"window.addEventListener('single-spa:routing-event', evt => {\n  console.log('single-spa finished mounting/unmounting applications!');\n  console.log(evt.detail.originalEvent); // PopStateEvent\n  console.log(evt.detail.newAppStatuses); // { app1: MOUNTED, app2: NOT_MOUNTED }\n  console.log(evt.detail.appsByNewStatus); // { MOUNTED: ['app1'], NOT_MOUNTED: ['app2'] }\n  console.log(evt.detail.totalAppChanges); // 2\n});\n")),(0,i.kt)("p",null,"A ",(0,i.kt)("inlineCode",{parentName:"p"},"single-spa:routing-event")," event is fired every time that a routing event has occurred, which is after each hashchange, popstate, or triggerAppChange, even if no changes to registered applications were necessary; and after single-spa verified that all apps were correctly loaded, bootstrapped, mounted, and unmounted."))}c.isMDXComponent=!0}}]);