"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[9611],{3905:function(e,t,n){n.d(t,{Zo:function(){return c},kt:function(){return h}});var i=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,i,a=function(e,t){if(null==e)return{};var n,i,a={},o=Object.keys(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var r=i.createContext({}),s=function(e){var t=i.useContext(r),n=t;return e&&(n="function"==typeof e?e(t):p(p({},t),e)),n},c=function(e){var t=s(e.components);return i.createElement(r.Provider,{value:t},e.children)},u="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},d=i.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,r=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),u=s(n),d=a,h=u["".concat(r,".").concat(d)]||u[d]||m[d]||o;return n?i.createElement(h,p(p({ref:t},c),{},{components:n})):i.createElement(h,p({ref:t},c))}));function h(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,p=new Array(o);p[0]=d;var l={};for(var r in t)hasOwnProperty.call(t,r)&&(l[r]=t[r]);l.originalType=e,l[u]="string"==typeof e?e:a,p[1]=l;for(var s=2;s<o;s++)p[s]=n[s];return i.createElement.apply(null,p)}return i.createElement.apply(null,n)}d.displayName="MDXCreateElement"},2945:function(e,t,n){n.r(t),n.d(t,{assets:function(){return c},contentTitle:function(){return r},default:function(){return d},frontMatter:function(){return l},metadata:function(){return s},toc:function(){return u}});var i=n(7462),a=n(3366),o=(n(7294),n(3905)),p=["components"],l={id:"configuration",title:"Configuring single-spa",sidebar_label:"Configuring single-spa"},r=void 0,s={unversionedId:"configuration",id:"version-5.x/configuration",title:"Configuring single-spa",description:"The single-spa root config consists of the following:",source:"@site/versioned_docs/version-5.x/single-spa-config.md",sourceDirName:".",slug:"/configuration",permalink:"/docs/5.x/configuration",draft:!1,editUrl:"https://github.com/single-spa/single-spa.js.org/blob/master/website/versioned_docs/version-5.x/single-spa-config.md",tags:[],version:"5.x",frontMatter:{id:"configuration",title:"Configuring single-spa",sidebar_label:"Configuring single-spa"},sidebar:"version-5.x/docs",previous:{title:"Microfrontend Types",permalink:"/docs/5.x/module-types"},next:{title:"single-spa applications",permalink:"/docs/5.x/building-applications"}},c={},u=[{value:"Index.html file",id:"indexhtml-file",level:2},{value:"Registering applications",id:"registering-applications",level:2},{value:"Using arguments",id:"using-arguments",level:3},{value:"Application name",id:"application-name",level:4},{value:"Loading Function or Application",id:"loading-function-or-application",level:4},{value:"Application as second argument",id:"application-as-second-argument",level:5},{value:"Loading function",id:"loading-function",level:5},{value:"Activity function",id:"activity-function",level:4},{value:"Custom props",id:"custom-props",level:4},{value:"Using configuration object",id:"using-configuration-object",level:3},{value:"config.name",id:"configname",level:4},{value:"config.app",id:"configapp",level:4},{value:"config.activeWhen",id:"configactivewhen",level:4},{value:"Path prefix",id:"path-prefix",level:4},{value:"config.customProps",id:"configcustomprops",level:4},{value:"Calling singleSpa.start()",id:"calling-singlespastart",level:2},{value:"Two registered applications simultaneously??",id:"two-registered-applications-simultaneously",level:2}],m={toc:u};function d(e){var t=e.components,n=(0,a.Z)(e,p);return(0,o.kt)("wrapper",(0,i.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"The single-spa root config consists of the following:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"The root HTML file that is shared by all single-spa applications."),(0,o.kt)("li",{parentName:"ol"},"The JavaScript that calls ",(0,o.kt)("a",{parentName:"li",href:"/docs/api#registerapplication"},(0,o.kt)("inlineCode",{parentName:"a"},"singleSpa.registerApplication()")),".")),(0,o.kt)("p",null,"Your root config exists only to start up the single-spa applications."),(0,o.kt)("h2",{id:"indexhtml-file"},"Index.html file"),(0,o.kt)("p",null,"See ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/polyglot-microfrontends/root-config/blob/master/src/index.ejs"},"this example root config")," for what a root HTML file looks like."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"You do not have to use SystemJS when using single-spa"),", but many examples and tutorials will encourage you to do so because\nit allows you to ",(0,o.kt)("a",{parentName:"p",href:"/docs/separating-applications"},"independently deploy")," your applications."),(0,o.kt)("h2",{id:"registering-applications"},"Registering applications"),(0,o.kt)("p",null,"You must register ",(0,o.kt)("a",{parentName:"p",href:"/docs/5.x/building-applications"},"applications")," with single-spa so it knows how and when to\ninitiate, load, mount, and unmount each application. Registration most commonly occurs inside of the single-spa config but\ndoes not have to. Note that if an application is registered from within another application, no hierarchy will be\nmaintained between the applications. Instead, the applications will be siblings and will be mounted\nand unmounted according to their own activity functions."),(0,o.kt)("p",null,"In order to register an application, call the ",(0,o.kt)("inlineCode",{parentName:"p"},"registerApplication")," function. Example:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'// single-spa-config.js\nimport { registerApplication, start } from "single-spa";\n\n// Simple usage\nregisterApplication(\n  "app2",\n  () => import("src/app2/main.js"),\n  (location) => location.pathname.startsWith("/app2"),\n  { some: "value" },\n);\n\n// Config with more expressive API\nregisterApplication({\n  name: "app1",\n  app: () => import("src/app1/main.js"),\n  activeWhen: "/app1",\n  customProps: {\n    some: "value",\n  },\n});\n\nstart();\n')),(0,o.kt)("h3",{id:"using-arguments"},"Using arguments"),(0,o.kt)("h4",{id:"application-name"},"Application name"),(0,o.kt)("p",null,"The first argument to ",(0,o.kt)("inlineCode",{parentName:"p"},"registerApplication")," must be a string name."),(0,o.kt)("h4",{id:"loading-function-or-application"},"Loading Function or Application"),(0,o.kt)("p",null,"The second argument to ",(0,o.kt)("inlineCode",{parentName:"p"},"registerApplication")," must be either a function that returns a promise ",(0,o.kt)("a",{parentName:"p",href:"configuration#loading-function"},"loading function")," or the resolved Application."),(0,o.kt)("h5",{id:"application-as-second-argument"},"Application as second argument"),(0,o.kt)("p",null,"Optionally for the second argument you can use the resolved Application, consisting of an object with the lifecycle methods.\nThis allows you import the Application from another file or define applications inline in your single-spa-config"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'const application = {\n  bootstrap: () => Promise.resolve(), //bootstrap function\n  mount: () => Promise.resolve(), //mount function\n  unmount: () => Promise.resolve(), //unmount function\n};\nregisterApplication("applicationName", application, activityFunction);\n')),(0,o.kt)("h5",{id:"loading-function"},"Loading function"),(0,o.kt)("p",null,"The second argument to ",(0,o.kt)("inlineCode",{parentName:"p"},"registerApplication")," must be a function that returns a promise (or an ",(0,o.kt)("a",{parentName:"p",href:"https://ponyfoo.com/articles/understanding-javascript-async-await"},'"async function"'),").\nThe function will be called with no arguments when it's time to load the application for the first time. The returned\npromise must be resolved with the application. The most common implementation of a loading function is an import call:\n",(0,o.kt)("inlineCode",{parentName:"p"},"() => import('/path/to/application.js')")),(0,o.kt)("h4",{id:"activity-function"},"Activity function"),(0,o.kt)("p",null,"The third argument to ",(0,o.kt)("inlineCode",{parentName:"p"},"registerApplication")," must be a pure function, the function is provided ",(0,o.kt)("inlineCode",{parentName:"p"},"window.location")," as the first argument, and returns a truthy\nvalue whenever the application should be active. Most commonly, the activity function determines if an application\nis active by looking at ",(0,o.kt)("inlineCode",{parentName:"p"},"window.location"),"/the first param."),(0,o.kt)("p",null,"Another way of looking at this is that single-spa is a top-level router that has a lot of applications that have their own sub-router."),(0,o.kt)("p",null,"single-spa will call each application's activity function under the following scenarios:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"hashchange")," or ",(0,o.kt)("inlineCode",{parentName:"li"},"popstate")," event"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"pushState")," or ",(0,o.kt)("inlineCode",{parentName:"li"},"replaceState")," is called"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"/docs/5.x/api#triggerappchange"},(0,o.kt)("inlineCode",{parentName:"a"},"triggerAppChange"))," api is called on single-spa"),(0,o.kt)("li",{parentName:"ul"},"Whenever the ",(0,o.kt)("inlineCode",{parentName:"li"},"checkActivityFunctions")," method is called")),(0,o.kt)("h4",{id:"custom-props"},"Custom props"),(0,o.kt)("p",null,"The optional fourth argument to ",(0,o.kt)("inlineCode",{parentName:"p"},"registerApplication")," is ",(0,o.kt)("a",{parentName:"p",href:"/docs/building-applications/#custom-props"},"custom props")," that are passed to the application's single-spa lifecycle functions. The custom props may be either an object or a function that returns an object. Custom prop functions are called with the application name and current ",(0,o.kt)("inlineCode",{parentName:"p"},"window.location")," as arguments."),(0,o.kt)("h3",{id:"using-configuration-object"},"Using configuration object"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'singleSpa.registerApplication({\n  name: "myApp",\n  app: () => import("src/myApp/main.js"),\n  activeWhen: [\n    "/myApp",\n    (location) => location.pathname.startsWith("/some/other/path"),\n  ],\n  customProps: {\n    some: "value",\n  },\n});\n\nsingleSpa.registerApplication({\n  name: "myApp",\n  app: () => import("src/myApp/main.js"),\n  activeWhen: [\n    "/myApp",\n    (location) => location.pathname.startsWith("/some/other/path"),\n  ],\n  customProps: (name, location) => ({\n    some: "value",\n  }),\n});\n')),(0,o.kt)("h4",{id:"configname"},"config.name"),(0,o.kt)("p",null,"Must be a string name"),(0,o.kt)("h4",{id:"configapp"},"config.app"),(0,o.kt)("p",null,"The definition of your app, which can be an object with single-spa lifecycle\nmethods, or a loading function, the same as the second argument on the arguments API"),(0,o.kt)("h4",{id:"configactivewhen"},"config.activeWhen"),(0,o.kt)("p",null,"Can be an activity function, like the arguments API, a path prefix or an array\nwith both. Since the most common use case is to look at the ",(0,o.kt)("inlineCode",{parentName:"p"},"window.location")," and match the URL with a\nprefix, we decided to do this for you!"),(0,o.kt)("h4",{id:"path-prefix"},"Path prefix"),(0,o.kt)("p",null,"The path prefix will match the start of your URL, allowing everything after the\nprefix. Examples:"),(0,o.kt)("dl",null,(0,o.kt)("dt",null,"'/app1'"),(0,o.kt)("dd",null,"\u2705 https://app.com/app1"),(0,o.kt)("dd",null,"\u2705 https://app.com/app1/anything/everything"),(0,o.kt)("dd",null,"\ud83d\udeab https://app.com/app2"),(0,o.kt)("dt",null,"'/users/:userId/profile'"),(0,o.kt)("dd",null,"\u2705 https://app.com/users/123/profile"),(0,o.kt)("dd",null,"\u2705 https://app.com/users/123/profile/sub-profile/"),(0,o.kt)("dd",null,"\ud83d\udeab https://app.com/users//profile/sub-profile/"),(0,o.kt)("dd",null,"\ud83d\udeab https://app.com/users/profile/sub-profile/"),(0,o.kt)("dt",null,"'/pathname/#/hash'"),(0,o.kt)("dd",null,"\u2705 https://app.com/pathname/#/hash"),(0,o.kt)("dd",null,"\u2705 https://app.com/pathname/#/hash/route/nested"),(0,o.kt)("dd",null,"\ud83d\udeab https://app.com/pathname#/hash/route/nested"),(0,o.kt)("dd",null,"\ud83d\udeab https://app.com/pathname#/another-hash"),(0,o.kt)("dt",null,"['/pathname/#/hash', '/app1']"),(0,o.kt)("dd",null,"\u2705 https://app.com/pathname/#/hash/route/nested"),(0,o.kt)("dd",null,"\u2705 https://app.com/app1/anything/everything"),(0,o.kt)("dd",null,"\ud83d\udeab https://app.com/pathname/app1"),(0,o.kt)("dd",null,"\ud83d\udeab https://app.com/app2")),(0,o.kt)("h4",{id:"configcustomprops"},"config.customProps"),(0,o.kt)("p",null,"The optional ",(0,o.kt)("inlineCode",{parentName:"p"},"customProps")," property provides ",(0,o.kt)("a",{parentName:"p",href:"/docs/building-applications/#custom-props"},"custom props")," that are passed to the application's single-spa lifecycle functions. The custom props may be either an object or a function that returns an object. Custom prop functions are called with the application name and current ",(0,o.kt)("inlineCode",{parentName:"p"},"window.location")," as arguments."),(0,o.kt)("h2",{id:"calling-singlespastart"},"Calling singleSpa.start()"),(0,o.kt)("p",null,"The ",(0,o.kt)("a",{parentName:"p",href:"/docs/5.x/api#start"},(0,o.kt)("inlineCode",{parentName:"a"},"start()")," api")," ",(0,o.kt)("strong",{parentName:"p"},"must")," be called by your single spa config in order for\napplications to actually be mounted. Before ",(0,o.kt)("inlineCode",{parentName:"p"},"start")," is called, applications will be loaded, but not bootstrapped/mounted/unmounted.\nThe reason for ",(0,o.kt)("inlineCode",{parentName:"p"},"start")," is to give you control over performance. For example, you may want to register applications\nimmediately (to start downloading the code for the active ones), but not actually mount the applications\nuntil an initial AJAX request (maybe to get information about the logged in user) has been completed. In that case,\nthe best performance is achieved by calling ",(0,o.kt)("inlineCode",{parentName:"p"},"registerApplication")," immediately, but calling ",(0,o.kt)("inlineCode",{parentName:"p"},"start")," after\nthe AJAX request is completed."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'//single-spa-config.js\nimport { start } from "single-spa";\n\n/* Calling start before registering apps means that single-spa can immediately mount apps, without\n * waiting for any initial setup of the single page app.\n */\nstart();\n\n// Register applications....\n')),(0,o.kt)("h2",{id:"two-registered-applications-simultaneously"},"Two registered applications simultaneously??"),(0,o.kt)("p",null,"Yep, it's possible. And it's actually not that scary if you do it right. And once you do,\nit's really really powerful. One approach to do this is to create a ",(0,o.kt)("inlineCode",{parentName:"p"},"<div>")," for each app,\nso that they never try to modify the same DOM at the same time."),(0,o.kt)("p",null,"The ",(0,o.kt)("inlineCode",{parentName:"p"},"<div>")," will need an ",(0,o.kt)("inlineCode",{parentName:"p"},"id")," starting with the prefix ",(0,o.kt)("inlineCode",{parentName:"p"},"single-spa-application:"),"\nand then your app name. For example, if you had an app called ",(0,o.kt)("inlineCode",{parentName:"p"},"app-name"),", you'd\nmake a ",(0,o.kt)("inlineCode",{parentName:"p"},"<div>")," with the id ",(0,o.kt)("inlineCode",{parentName:"p"},"single-spa-application:app-name"),"."),(0,o.kt)("p",null,"An example with multiple applications would look like this:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-html"},'<div id="single-spa-application:app-name"></div>\n<div id="single-spa-application:other-app"></div>\n')))}d.isMDXComponent=!0}}]);